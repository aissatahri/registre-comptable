<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.Button?>
<?import javafx.scene.control.ComboBox?>
<?import javafx.scene.control.MenuButton?>
<?import javafx.scene.control.Pagination?>
<?import javafx.scene.control.ScrollPane?>
<?import javafx.scene.control.TableColumn?>
<?import javafx.scene.control.TableView?>
<?import javafx.scene.control.TextField?>
<?import javafx.scene.layout.BorderPane?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.Region?>
<?import javafx.scene.layout.VBox?>
<?import javafx.scene.text.Text?>

<BorderPane xmlns="http://javafx.com/javafx/21" xmlns:fx="http://javafx.com/fxml/1" fx:controller="com.app.registre.controller.RegistreController">

    <top>
        <VBox spacing="15" styleClass="page-header">
            <HBox alignment="CENTER_LEFT" spacing="20">
                <VBox>
                    <Text styleClass="title" text="Registre des Opérations" />
                    <Text styleClass="subtitle" text="Gestion complète des opérations comptables" />
                </VBox>
                <Region HBox.hgrow="ALWAYS" />
                <Button onAction="#showAddOperationDialog" styleClass="btn-primary" text="Nouvelle Opération" />
                <Button onAction="#importFromExcel" styleClass="btn-success" text="Importer Excel" />
                <Button onAction="#exportToExcel" styleClass="btn-success" text="Exporter Excel" />
                <Button onAction="#deleteAllOperations" styleClass="btn-danger" text="Supprimer tout" />
                <Button onAction="#deleteSelectedOperations" styleClass="btn-danger" text="Supprimer sélection" />
            </HBox>

            <HBox alignment="CENTER_LEFT" spacing="10">
                <TextField fx:id="searchField" promptText="Rechercher..." HBox.hgrow="ALWAYS" />
                <ComboBox fx:id="filterMois" promptText="Filtrer par mois" />
                <ComboBox fx:id="filterAnnee" promptText="Filtrer par année" />
                <ComboBox fx:id="filterNature" promptText="Filtrer par nature" />
                <Button onAction="#applyFilters" text="Filtrer" />
                <Button onAction="#resetFilters" text="Réinitialiser" />
                <MenuButton fx:id="columnsMenu" text="Colonnes" />
            </HBox>
        </VBox>
    </top>

    <center>
        <ScrollPane fitToHeight="true" fitToWidth="false" hbarPolicy="AS_NEEDED" vbarPolicy="AS_NEEDED">
            <BorderPane.margin>
                <Insets bottom="20" left="20" right="20" top="20" />
            </BorderPane.margin>
            <content>
                <TableView fx:id="operationsTable" editable="true">
                    <columns>
                <TableColumn fx:id="selectColumn" editable="true" prefWidth="40" text="" />
                <!-- Order aligned with operation dialog: IMP, Désignation, Nature, N, BUDG, Date Emission, Date Visa, OV/CHEQ, Solde, ... -->
                <TableColumn fx:id="colArt" prefWidth="70" text="ART" />
                <TableColumn fx:id="colPar" prefWidth="70" text="PAR" />
                <TableColumn fx:id="colLig" prefWidth="70" text="LIG" />
                <TableColumn fx:id="colImp" prefWidth="80" text="IMP" />
                <TableColumn fx:id="colDesignation" prefWidth="200" text="Désignation" />
                <TableColumn fx:id="colNature" prefWidth="120" text="Nature" />
                <TableColumn fx:id="colN" prefWidth="60" text="N" />
                <TableColumn fx:id="colBudg" prefWidth="80" text="BUDG" />
                <TableColumn fx:id="colExercice" prefWidth="80" text="Exercice" />
                <TableColumn fx:id="colBeneficiaire" prefWidth="160" text="Bénéficiaire" />
                <TableColumn fx:id="colDateEmission" prefWidth="110" text="Date Emission" />
                <TableColumn fx:id="colOpOr" prefWidth="80" text="OP/OR" />
                <TableColumn fx:id="colOvCheq" prefWidth="80" text="OV/CHEQ" />
                <TableColumn fx:id="colRecette" prefWidth="100" text="Recette" />
                <TableColumn fx:id="colSurRam" prefWidth="100" text="Sur RAM" />
                <TableColumn fx:id="colSurEng" prefWidth="100" text="Sur Eng" />
                <TableColumn fx:id="colDepense" prefWidth="100" text="Dépense" />
                <TableColumn fx:id="colMontant" prefWidth="100" text="Solde" />
                <TableColumn fx:id="actionsColumn" prefWidth="120" text="Actions" />
            </columns>
         <columnResizePolicy>
            <TableView fx:constant="CONSTRAINED_RESIZE_POLICY" />
         </columnResizePolicy>
                </TableView>
            </content>
        </ScrollPane>
    </center>

    <bottom>
        <VBox spacing="10">
            <HBox alignment="CENTER_LEFT" spacing="20" styleClass="page-footer">
                <VBox>
                    <Text style="-fx-font-weight: bold;" text="Total des opérations:" />
                    <Text fx:id="totalOperationsText" style="-fx-font-size: 16; -fx-fill: #2c3e50;" text="0" />
                </VBox>
                <VBox>
                    <Text style="-fx-font-weight: bold;" text="Solde:" />
                    <Text fx:id="totalMontantText" style="-fx-font-size: 16; -fx-fill: #27ae60;" text="0.00" />
                </VBox>
                <VBox />
                <VBox />
                <Region HBox.hgrow="ALWAYS" />
                <javafx.scene.control.Pagination fx:id="pagination" maxPageIndicatorCount="10" />
            </HBox>
        </VBox>
    </bottom>

</BorderPane>
