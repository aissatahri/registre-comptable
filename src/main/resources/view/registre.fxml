<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.Button?>
<?import javafx.scene.control.ComboBox?>
<?import javafx.scene.control.MenuButton?>
<?import javafx.scene.control.TableColumn?>
<?import javafx.scene.control.TableView?>
<?import javafx.scene.control.TextField?>
<?import javafx.scene.layout.BorderPane?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.Region?>
<?import javafx.scene.layout.VBox?>
<?import javafx.scene.text.Text?>

<BorderPane xmlns="http://javafx.com/javafx/21" xmlns:fx="http://javafx.com/fxml/1" fx:controller="com.app.registre.controller.RegistreController">

    <top>
        <VBox spacing="15" style="-fx-background-color: white; -fx-padding: 20;">
            <HBox alignment="CENTER_LEFT" spacing="20">
                <VBox>
                    <Text styleClass="title" text="Registre des Opérations" />
                    <Text styleClass="subtitle" text="Gestion complète des opérations comptables" />
                </VBox>
                <Region HBox.hgrow="ALWAYS" />
                <Button onAction="#showAddOperationDialog" styleClass="btn-primary" text="Nouvelle Opération" />
                <Button onAction="#importFromExcel" styleClass="btn-success" text="Importer Excel" />
                <Button onAction="#exportToExcel" styleClass="btn-success" text="Exporter Excel" />
                <Button onAction="#deleteAllOperations" styleClass="btn-danger" text="Supprimer tout" />
                <Button onAction="#deleteSelectedOperations" styleClass="btn-danger" text="Supprimer sélection" />
            </HBox>

            <HBox alignment="CENTER_LEFT" spacing="10">
                <TextField fx:id="searchField" promptText="Rechercher..." HBox.hgrow="ALWAYS" />
                <ComboBox fx:id="filterMois" promptText="Filtrer par mois" />
                <ComboBox fx:id="filterNature" promptText="Filtrer par nature" />
                <Button onAction="#applyFilters" text="Filtrer" />
                <Button onAction="#resetFilters" text="Réinitialiser" />
                <MenuButton fx:id="columnsMenu" text="Colonnes" />
            </HBox>
        </VBox>
    </top>

    <center>
        <TableView fx:id="operationsTable" editable="true">
            <BorderPane.margin>
                <Insets bottom="20" left="20" right="20" top="20" />
            </BorderPane.margin>
            <columns>
                <TableColumn fx:id="selectColumn" editable="true" prefWidth="40" text="" />
                <TableColumn fx:id="colOp" prefWidth="80" text="OP" />
                <TableColumn fx:id="colOvCheq" prefWidth="80" text="OV/CHEQ" />
                <TableColumn fx:id="colImp" prefWidth="80" text="IMP" />
                <TableColumn fx:id="colNature" prefWidth="120" text="Nature" />
                <TableColumn fx:id="colBudg" prefWidth="80" text="BUDG" />
                <TableColumn fx:id="colMontant" prefWidth="100" text="Montant" />
                <TableColumn fx:id="colDateEntree" prefWidth="110" text="Date Entrée" />
                <TableColumn fx:id="colDateVisa" prefWidth="110" text="Date Visa" />
                <TableColumn fx:id="colDateRejet" prefWidth="110" text="Date Rejet" />
                <TableColumn fx:id="colMotifRejet" prefWidth="160" text="Motif Rejet" />
                <TableColumn fx:id="colDateReponse" prefWidth="120" text="Date Réponse" />
                <TableColumn fx:id="colContenuReponse" prefWidth="180" text="Contenu Réponse" />
                <TableColumn fx:id="colMois" prefWidth="80" text="Mois" />
                <TableColumn fx:id="colDecision" prefWidth="100" text="Décision" />
                <TableColumn fx:id="actionsColumn" prefWidth="120" text="Actions" />
            </columns>
         <columnResizePolicy>
            <TableView fx:constant="CONSTRAINED_RESIZE_POLICY" />
         </columnResizePolicy>
        </TableView>
    </center>

    <bottom>
        <HBox alignment="CENTER_LEFT" spacing="20" style="-fx-background-color: #f8f9fa; -fx-padding: 15;">
            <VBox>
                <Text style="-fx-font-weight: bold;" text="Total des opérations:" />
                <Text fx:id="totalOperationsText" style="-fx-font-size: 16; -fx-fill: #2c3e50;" text="0" />
            </VBox>
            <VBox>
                <Text style="-fx-font-weight: bold;" text="Montant total:" />
                <Text fx:id="totalMontantText" style="-fx-font-size: 16; -fx-fill: #27ae60;" text="0.00" />
            </VBox>
            <VBox>
                <Text style="-fx-font-weight: bold;" text="Dossiers payés:" />
                <Text fx:id="dossiersPayesText" style="-fx-font-size: 16; -fx-fill: #3498db;" text="0" />
            </VBox>
            <VBox>
                <Text style="-fx-font-weight: bold;" text="Dossiers rejetés:" />
                <Text fx:id="dossiersRejetesText" style="-fx-font-size: 16; -fx-fill: #e74c3c;" text="0" />
            </VBox>
        </HBox>
    </bottom>

</BorderPane>
